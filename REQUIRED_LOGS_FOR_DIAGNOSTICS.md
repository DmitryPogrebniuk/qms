# –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –ª–æ–≥–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ MediaSense

**–î–∞—Ç–∞:** 26 —Å—ñ—á–Ω—è 2026  
**–ü—Ä–æ–±–ª–µ–º–∞:** 404 –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ª–æ–≥—ñ–Ω—ñ, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å JSESSIONID, —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –Ω–µ –ø—Ä–∞—Ü—é—î

---

## –ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç–æ—á–Ω–∏—Ö –ª–æ–≥—ñ–≤

### –í–∏—è–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏:

1. **404 Not Found –ø—Ä–∏ –ª–æ–≥—ñ–Ω—ñ**
   - Endpoint `/j_security_check` –∞–±–æ `/ora/authenticationService/authentication/login` –ø–æ–≤–µ—Ä—Ç–∞—î 404
   - HTML –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ Cisco: "Cisco System - Error report"
   - –¶–µ –Ω–æ–≤–µ - —Ä–∞–Ω—ñ—à–µ –±—É–≤ HTTP 200 –∑ responseCode 4021

2. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å JSESSIONID cookie**
   - Basic Auth –ø—Ä–∞—Ü—é—î, –∞–ª–µ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î cookie
   - Query endpoints –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å 4021 –±–µ–∑ cookie

3. **Playwright automation –Ω–µ –≤–∏–¥–Ω–æ –≤ –ª–æ–≥–∞—Ö**
   - –ù–µ –≤–∏–¥–Ω–æ –ª–æ–≥—ñ–≤ –ø—Ä–æ —Å–ø—Ä–æ–±—É –æ—Ç—Ä–∏–º–∞—Ç–∏ cookie —á–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - –ú–æ–∂–ª–∏–≤–æ automation –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∞–±–æ –Ω–µ –ø—Ä–∞—Ü—é—î

4. **–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –Ω–µ –æ—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ**
   - `fetched: 0` - —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –Ω–µ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ
   - `errors: 0` - –ø–æ–º–∏–ª–∫–∏ –Ω–µ —Ñ—ñ–∫—Å—É—é—Ç—å—Å—è (–º–æ–∂–ª–∏–≤–æ –Ω–µ –¥–æ—Å—è–≥–∞—é—Ç—å —Ü—å–æ–≥–æ –∫—Ä–æ–∫—É)

---

## –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –ª–æ–≥–∏

### 1. –õ–æ–≥–∏ Playwright/Cookie Service (–ö–†–ò–¢–ò–ß–ù–û)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –ß–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è Playwright automation?
- –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É –±—Ä–∞—É–∑–µ—Ä–∞?
- –ß–∏ –≤–¥–∞—î—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ cookie —á–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å?

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –õ–æ–≥–∏ cookie service
sudo docker compose -f infra/docker-compose.yml logs api | grep -i "cookie\|playwright\|browser\|chromium\|web interface" | tail -50

# –í—Å—ñ –ª–æ–≥–∏ –∑ MediaSenseCookieService
sudo docker compose -f infra/docker-compose.yml logs api | grep -i "MediaSenseCookieService\|cookie.*service" | tail -50
```

**–©–æ —à—É–∫–∞—Ç–∏:**
- `[MediaSenseCookieService]` - –ª–æ–≥–∏ —Å–µ—Ä–≤—ñ—Å—É
- `Fetching JSESSIONID from web interface` - —Å–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ cookie
- `Browser launch failed` - –ø–æ–º–∏–ª–∫–∏ –∑–∞–ø—É—Å–∫—É –±—Ä–∞—É–∑–µ—Ä–∞
- `Login form fields not found` - –ø—Ä–æ–±–ª–µ–º–∏ –∑ —Ñ–æ—Ä–º–æ—é –ª–æ–≥—ñ–Ω—É
- `JSESSIONID cookie not found` - cookie –Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ

---

### 2. –î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –∑–∞–ø–∏—Ç—ñ–≤ –∑ headers (–í–ê–ñ–õ–ò–í–û)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –¢–æ—á–Ω—ñ URL endpoint'—ñ–≤, —è–∫—ñ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å—Å—è
- Headers –∑–∞–ø–∏—Ç—ñ–≤ (Authorization, Content-Type, Accept)
- –ü–æ–≤–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (headers + body)
- –ß–æ–º—É `/j_security_check` –ø–æ–≤–µ—Ä—Ç–∞—î 404?

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –∑ requestId
sudo docker compose -f infra/docker-compose.yml logs api | grep -A 10 -B 5 "requestId.*login\|Attempting.*login\|404\|j_security_check" | tail -100

# –õ–æ–≥–∏ –∑ –ø–æ–≤–Ω–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–ø–∏—Ç—ñ–≤
sudo docker compose -f infra/docker-compose.yml logs api | grep -i "mediasense.*request\|mediasense.*response\|mediasense.*error" | tail -100
```

**–©–æ —à—É–∫–∞—Ç–∏:**
- –¢–æ—á–Ω–∏–π URL, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è (–º–æ–∂–ª–∏–≤–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π endpoint)
- HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥–∏
- Set-Cookie –∑–∞–≥–æ–ª–æ–≤–∫–∏
- Response body –∑ –ø–æ–º–∏–ª–∫–∞–º–∏

---

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ Playwright –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ (–í–ê–ñ–õ–ò–í–û)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –ß–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π Chromium –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ?
- –ß–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π Playwright?
- –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π Dockerfile?

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Chromium
sudo docker compose -f infra/docker-compose.yml exec api which chromium
sudo docker compose -f infra/docker-compose.yml exec api chromium --version

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Playwright
sudo docker compose -f infra/docker-compose.yml exec api node -e "require('playwright')"

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ environment variables
sudo docker compose -f infra/docker-compose.yml exec api env | grep -i "playwright\|chromium"
```

**–©–æ —à—É–∫–∞—Ç–∏:**
- Chromium –º–∞—î –±—É—Ç–∏ –≤ `/usr/bin/chromium`
- Playwright –º–∞—î –±—É—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π
- Environment variables –º–∞—é—Ç—å –±—É—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ

---

### 4. –õ–æ–≥–∏ –ø–æ–º–∏–ª–æ–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É –±—Ä–∞—É–∑–µ—Ä–∞ (–í–ê–ñ–õ–ò–í–û)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –±—Ä–∞—É–∑–µ—Ä?
- –ß–∏ —î –ø—Ä–æ–±–ª–µ–º–∏ –∑ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø—É?
- –ß–∏ —î –ø—Ä–æ–±–ª–µ–º–∏ –∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏?

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –í—Å—ñ –ø–æ–º–∏–ª–∫–∏ –∑ –±—Ä–∞—É–∑–µ—Ä–æ–º
sudo docker compose -f infra/docker-compose.yml logs api | grep -i "browser\|chromium\|playwright\|launch.*failed\|executable.*not.*found" | tail -50

# –°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–º–∏–ª–∫–∏
sudo docker compose -f infra/docker-compose.yml logs api | grep -i "error\|exception\|failed" | tail -100
```

---

### 5. –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑ –¥–µ—Ç–∞–ª—è–º–∏ (–í–ê–ñ–õ–ò–í–û)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –ß–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è?
- –ù–∞ —è–∫–æ–º—É –µ—Ç–∞–ø—ñ –≤–æ–Ω–∞ –ø–∞–¥–∞—î?
- –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –∑–∞–ø–∏—Ç—ñ –¥–æ MediaSense?

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
sudo docker compose -f infra/docker-compose.yml logs api | grep -i "sync\|mediasense.*sync\|incremental.*sync" | tail -100

# –õ–æ–≥–∏ –∑ correlation ID
sudo docker compose -f infra/docker-compose.yml logs api | grep -E "\[ms-[a-z0-9-]+\]" | tail -50
```

---

### 6. Network traffic capture (–û–ü–¶–Ü–û–ù–ê–õ–¨–ù–û, –∞–ª–µ –∫–æ—Ä–∏—Å–Ω–æ)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –¢–æ—á–Ω—ñ HTTP –∑–∞–ø–∏—Ç–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- Cookies –≤ headers
- –ü–æ–≤–Ω—ñ response body

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É –¥–æ MediaSense
sudo tcpdump -i any -A -s 0 'host 192.168.200.133 and port 8440' -w mediasense-traffic.pcap

# –ê–±–æ —á–µ—Ä–µ–∑ curl –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –≤–∏–≤–æ–¥–æ–º
curl -k -v -X POST "https://192.168.200.133:8440/j_security_check" \
  -d "j_username=USER&j_password=PASS" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  2>&1 | tee mediasense-request.log
```

---

### 7. –õ–æ–≥–∏ MediaSense —Å–µ—Ä–≤–µ—Ä–∞ (—è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω—ñ)

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –©–æ –ª–æ–≥—É—î MediaSense —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ –Ω–∞—à–∏—Ö –∑–∞–ø–∏—Ç–∞—Ö?
- –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞?
- –ß–∏ –±–ª–æ–∫—É—î —Å–µ—Ä–≤–µ—Ä –Ω–∞—à—ñ –∑–∞–ø–∏—Ç–∏?

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –¶–µ –ø–æ—Ç—Ä–µ–±—É—î –¥–æ—Å—Ç—É–ø—É –¥–æ MediaSense —Å–µ—Ä–≤–µ—Ä–∞.

---

### 8. –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Ç–∞ —Ä–µ—Å—É—Ä—Å–∏

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:**
- –ß–∏ –ø—Ä–∞—Ü—é—î –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–æ—Ä–º–∞–ª—å–Ω–æ?
- –ß–∏ —î –ø—Ä–æ–±–ª–µ–º–∏ –∑ –ø–∞–º'—è—Ç—Ç—é/CPU?
- –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ?

**–ö–æ–º–∞–Ω–¥–∏:**
```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
sudo docker compose -f infra/docker-compose.yml ps api

# –†–µ—Å—É—Ä—Å–∏
sudo docker stats qms-api --no-stream

# –õ–æ–≥–∏ —Å—Ç–∞—Ä—Ç—É
sudo docker compose -f infra/docker-compose.yml logs api | head -100
```

---

## –®–≤–∏–¥–∫–∏–π –∑–±—ñ—Ä –≤—Å—ñ—Ö –ª–æ–≥—ñ–≤

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Å—Ç–≤–æ—Ä–µ–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏:

```bash
# –î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
sudo ./diagnose-mediasense-detailed.sh

# –ó–±—ñ—Ä –≤—Å—ñ—Ö –ª–æ–≥—ñ–≤
sudo ./collect-mediasense-logs.sh
```

---

## –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω—ñ—Å—Ç—å –ª–æ–≥—ñ–≤

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –Ω–µ–≥–∞–π–Ω–æ):

1. **–õ–æ–≥–∏ Playwright/Cookie Service**
   - –ß–∏ –ø—Ä–∞—Ü—é—î automation?
   - –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É –±—Ä–∞—É–∑–µ—Ä–∞?

2. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ Playwright –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ**
   - –ß–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π Chromium?
   - –ß–∏ –ø—Ä–∞—Ü—é—î Playwright?

3. **–î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –∑–∞–ø–∏—Ç—ñ–≤ –∑ 404 –ø–æ–º–∏–ª–∫–æ—é**
   - –Ø–∫–∏–π —Ç–æ—á–Ω–æ endpoint –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è?
   - –ß–æ–º—É –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è 404?

### üü° –í–ê–ñ–õ–ò–í–û (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è –ø–æ–≤–Ω–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏):

4. **–õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑ –¥–µ—Ç–∞–ª—è–º–∏**
   - –ù–∞ —è–∫–æ–º—É –µ—Ç–∞–ø—ñ –ø–∞–¥–∞—î —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è?

5. **–õ–æ–≥–∏ –ø–æ–º–∏–ª–æ–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É –±—Ä–∞—É–∑–µ—Ä–∞**
   - –ß–∏ —î —Å–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–º–∏–ª–∫–∏?

### üü¢ –ö–û–†–ò–°–ù–û (–¥–ª—è –≥–ª–∏–±–æ–∫–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏):

6. **Network traffic capture**
   - –¢–æ—á–Ω—ñ HTTP –∑–∞–ø–∏—Ç–∏/–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

7. **–õ–æ–≥–∏ MediaSense —Å–µ—Ä–≤–µ—Ä–∞**
   - –©–æ –±–∞—á–∏—Ç—å —Å–µ—Ä–≤–µ—Ä?

---

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏ –ø—ñ—Å–ª—è –∑–±–æ—Ä—É –ª–æ–≥—ñ–≤

1. **–Ø–∫—â–æ Playwright –Ω–µ –ø—Ä–∞—Ü—é—î:**
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Dockerfile
   - –ó—Ä–æ–±–∏—Ç–∏ rebuild –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å Chromium

2. **–Ø–∫—â–æ 404 –ø–æ–º–∏–ª–∫–∞:**
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å endpoint'—ñ–≤
   - –ú–æ–∂–ª–∏–≤–æ MediaSense –≤–µ—Ä—Å—ñ—è –º–∞—î —ñ–Ω—à—ñ endpoints
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

3. **–Ø–∫—â–æ cookie –Ω–µ –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è:**
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥—ñ–∫—É –≤ MediaSenseCookieService
   - –ú–æ–∂–ª–∏–≤–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ —Ñ–æ—Ä–º–∏ –ª–æ–≥—ñ–Ω—É
   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ credentials

---

**–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** 26 —Å—ñ—á–Ω—è 2026
