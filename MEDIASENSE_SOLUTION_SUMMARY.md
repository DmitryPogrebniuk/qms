# MediaSense API - –ü—ñ–¥—Å—É–º–æ–∫ —Ä—ñ—à–µ–Ω–Ω—è

## –°—Ç–∞—Ç—É—Å

‚úÖ **–ö–æ–¥ –≥–æ—Ç–æ–≤–∏–π** - –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤–Ω–µ—Å–µ–Ω–æ
üìö **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∑—ñ–±—Ä–∞–Ω–∞** - –∞—Ä—Ö—ñ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è Cisco –∑–Ω–∞–π–¥–µ–Ω–∞ —Ç–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–∞
‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è** - MediaSense –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î JSESSIONIDSSO cookie –ø—Ä–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

## –©–æ –∑—Ä–æ–±–ª–µ–Ω–æ

### 1. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É

‚úÖ **–û–±—Ä–æ–±–∫–∞ Set-Cookie –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤** - –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è Node.js/axios
‚úÖ **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ JSESSIONIDSSO** - –∫–æ–¥ —à—É–∫–∞—î JSESSIONIDSSO –ø–µ—Ä–µ–¥ JSESSIONID
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** - –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ 4021
‚úÖ **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –º–∞–π–±—É—Ç–Ω—ñ—Ö –¥–∞—Ç** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ —Å–∫–∏–¥–∞–Ω–Ω—è
‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫** - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ responseCode –≤ body

### 2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

‚úÖ **MEDIASENSE_API_DOCUMENTATION_COMPLETE.md** - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∑ –∞—Ä—Ö—ñ–≤–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª
‚úÖ **SUPPORT_REQUEST_MEDIASENSE.md** - –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ (—è–∫—â–æ –± –≤–æ–Ω–∞ –±—É–ª–∞)
‚úÖ **–î—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏** - –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –∑–∞–ø–∏—Ç—ñ–≤

### 3. –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

‚úÖ **–°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–∏:**
- `diagnose-mediasense-auth.sh` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- `test-mediasense-query.sh` - —Ç–µ—Å—Ç –∑–∞–ø–∏—Ç—ñ–≤
- `fix-mediasense-auth-and-sync.sh` - –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó

## –ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞

**MediaSense API –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î Set-Cookie –∑–∞–≥–æ–ª–æ–≤–∫–∏** –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ:
- `POST /ora/authenticationService/authentication/login` –∑ Basic Auth
- `GET /ora/serviceInfo` –∑ Basic Auth
- `POST /j_security_check` (–ø–æ–≤–µ—Ä—Ç–∞—î 404)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ–º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ JSESSIONIDSSO cookie, —Ç–æ–º—É query endpoints –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å `responseCode: 4021`.

## –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏

1. **–í–µ—Ä—Å—ñ—è MediaSense** - –º–æ–∂–ª–∏–≤–æ, –≤–∞—à–∞ –≤–µ—Ä—Å—ñ—è –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î cookie-based –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
2. **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤–µ—Ä–∞** - –º–æ–∂–ª–∏–≤–æ, –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ MediaSense –≤–∏–º–∫–Ω–µ–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è cookies
3. **–ü–æ—Ä—Ç/URL** - –º–æ–∂–ª–∏–≤–æ, –ø–æ—Ç—Ä—ñ–±–µ–Ω —ñ–Ω—à–∏–π –ø–æ—Ä—Ç –∞–±–æ URL –¥–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
4. **–í–µ—Ä—Å—ñ—è API** - –º–æ–∂–ª–∏–≤–æ, –ø–æ—Ç—Ä—ñ–±–µ–Ω —ñ–Ω—à–∏–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Ç—É

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

### 1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–µ—Ä—Å—ñ—é MediaSense

```bash
# –°–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–µ—Ä—Å—ñ—é
curl -k -u "user:pass" https://192.168.200.133:8440/ora/serviceInfo
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å MediaSense

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å MediaSense –≤ –±—Ä–∞—É–∑–µ—Ä—ñ:
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫ –≤—ñ–Ω –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Network tab –≤ DevTools - —è–∫—ñ cookies –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫—ñ endpoints –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è

### 3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ MediaSense —Å–µ—Ä–≤–µ—Ä–∞

–ú–æ–∂–ª–∏–≤–æ, –≤ –ª–æ–≥–∞—Ö MediaSense —î –ø—ñ–¥–∫–∞–∑–∫–∏ –ø—Ä–æ —Ç–µ, —á–æ–º—É cookie –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è:
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ MediaSense
- –®—É–∫–∞–π—Ç–µ –ø–æ–º–∏–ª–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –±–µ–∑–ø–µ–∫–∏

### 4. –°–ø—Ä–æ–±—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –º–µ—Ç–æ–¥–∏

#### –í–∞—Ä—ñ–∞–Ω—Ç A: –ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

–ú–æ–∂–ª–∏–≤–æ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å MediaSense –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è cookie, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –≤ API:

```bash
# 1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
# 2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—è
# 3. –°–∫–æ–ø—ñ—é–π—Ç–µ JSESSIONIDSSO –∑ cookies –±—Ä–∞—É–∑–µ—Ä–∞
# 4. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –π–æ–≥–æ –≤ API –∑–∞–ø–∏—Ç–∞—Ö
```

#### –í–∞—Ä—ñ–∞–Ω—Ç B: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Selenium/Playwright

–ê–≤—Ç–æ–º–∞—Ç–∏–∑—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è cookie —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:

```typescript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥
const browser = await launchBrowser();
await browser.goto('https://192.168.200.133:8440');
await browser.login('user', 'pass');
const cookies = await browser.getCookies();
const jsessionId = cookies.find(c => c.name === 'JSESSIONIDSSO');
```

#### –í–∞—Ä—ñ–∞–Ω—Ç C: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏—Ö endpoints

–ú–æ–∂–ª–∏–≤–æ, —î —ñ–Ω—à—ñ endpoints –¥–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó:

```bash
# –°–ø—Ä–æ–±—É–π—Ç–µ —Ä—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
/ora/authenticate
/ora/auth/login
/ora/security/login
/j_security_check (–º–æ–∂–ª–∏–≤–æ, –Ω–∞ —ñ–Ω—à–æ–º—É –ø–æ—Ä—Ç—É)
```

### 5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é MediaSense

–ú–æ–∂–ª–∏–≤–æ, –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ MediaSense:
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –¥–æ–∑–≤–æ–ª–µ–Ω–æ cookie-based –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–µ –±–ª–æ–∫—É—î firewall/–ø—Ä–æ–∫—Å—ñ cookies

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. ‚úÖ **–ö–æ–¥ –≥–æ—Ç–æ–≤–∏–π** - –≤—Å—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤–Ω–µ—Å–µ–Ω–æ
2. ‚è≥ **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, —è–∫ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î
3. ‚è≥ **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ MediaSense** - –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—ñ–¥–∫–∞–∑–∫–∏
4. ‚è≥ **–°–ø—Ä–æ–±—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –º–µ—Ç–æ–¥–∏** - —è–∫—â–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å

## –§–∞–π–ª–∏ –¥–ª—è –¥–æ–≤—ñ–¥–∫–∏

- **MEDIASENSE_API_DOCUMENTATION_COMPLETE.md** - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- **SUPPORT_REQUEST_MEDIASENSE.md** - –æ–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏
- **MEDIASENSE_API_AUTHENTICATION.md** - –º–µ—Ç–æ–¥–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- **apps/api/src/modules/media-sense/media-sense-client.service.ts** - –∫–æ–¥ –∫–ª—ñ—î–Ω—Ç–∞

## –í–∏—Å–Ω–æ–≤–æ–∫

–ö–æ–¥ –≥–æ—Ç–æ–≤–∏–π —ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º—É, —â–æ MediaSense —Å–µ—Ä–≤–µ—Ä –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î JSESSIONIDSSO cookie –ø—Ä–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ API. –¶–µ –º–æ–∂–µ –±—É—Ç–∏:
- –û—Å–æ–±–ª–∏–≤—ñ—Å—Ç—å –≤–µ—Ä—Å—ñ—ó MediaSense
- –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤–µ—Ä–∞
- –û–±–º–µ–∂–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å MediaSense —Ç–∞ –π–æ–≥–æ –ª–æ–≥–∏ –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –ø—ñ–¥–∫–∞–∑–æ–∫.
